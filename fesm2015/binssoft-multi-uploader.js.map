{"version":3,"file":"binssoft-multi-uploader.js","sources":["ng://@binssoft/multi-uploader/lib/multi-uploader.service.ts","ng://@binssoft/multi-uploader/lib/multi-uploader.component.ts","ng://@binssoft/multi-uploader/lib/multi-uploader.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MultiUploaderService {\n\n  constructor() { }\n}\n","import { Component, OnInit, Input, Output, ViewChild, ElementRef, AfterViewInit  } from '@angular/core';\nimport { HttpEvent, HttpEventType, HttpClient , HttpHeaders } from '@angular/common/http';\n\n@Component({\n  selector: 'multi-uploader',\n  templateUrl:'./multi-uploader.component.html',\n \n  styleUrls: [\n    './multi-uploader.component.scss'\n  ]\n})\nexport class MultiUploaderComponent implements OnInit, AfterViewInit {\n  headers = new HttpHeaders();\n  @ViewChild('fileUploader',null) fileUploader: ElementRef;\n  @Input()config:any = {};\n  files:any = [];\n  previewFiles:any= [];\n  allowedExt:any = [\n    'jpg','jpeg','png','pdf','gif','txt'\n  ];\n  errors:any = [];\n  constructor(private http: HttpClient  ) { }\n\n  ngOnInit() {\n    if (this.config) {\n      if (!this.config.preview) {\n        this.config.preview = false;\n      }\n      if (!this.config.type) {\n        this.config.type = 'base64';\n      }\n    }\n   \n  }\n  ngAfterViewInit() {\n    // this.fileUploader = this.fileUploader.nativeElement;\n  }\n  clickOnUploader() {\n    this.fileUploader.nativeElement.click();\n  }\n  uploadPreviewProcess() {\n    if (this.fileUploader.nativeElement.files.length > 0) {\n      this.files = [...this.fileUploader.nativeElement.files];\n      this.files.map((file)=>{\n        let f = new FileReader();\n        f.onload = (e:any) =>\n        {\n          let ext = file.name.split('.').pop().toLowerCase();\n          let icon = null;\n          switch(ext) {\n            case 'pdf':\n              icon = 'pdf';\n              break;\n            case 'jpg':\n            case 'jpeg':\n            case 'png':\n            case 'gif':\n                icon = 'img';\n                break;\n            case 'wav':\n            case 'mp3':\n              icon = 'audio';\n              break;\n            default:\n              icon = 'file';\n              break;\n          }\n          this.previewFiles.push(\n           {\n             binaryFile:file,\n             file: e.target.result,\n             name: file.name,\n             ext:icon,\n             progress:0,\n             uploadStatus:false\n           }\n          )\n        }\n        f.readAsDataURL(file);\n      });\n    }\n  }\n  removeFile(index:any) {\n    this.previewFiles.splice(index,1);\n  }\n  uploadFile(index:any=null) {\n    if(this.config.upload) {\n      let uploadFile = this.previewFiles[index];\n      let uploadRequest:any =null;\n      if (this.config.upload.headers) {\n        Object.keys(this.config.upload.headers).map((i)=>{\n          this.headers.set(i, this.config.upload.headers[i]);\n        })\n      };\n      let body = this.config.upload.body;\n      if (this.config.type == 'base64') {\n        body['file'] = uploadFile.file;\n        body['file_name']  = uploadFile.name;\n        body = JSON.stringify(body);\n      } else if (this.config.type == 'binary') {\n        const uploadData = new FormData();\n        Object.keys(body).map((k)=>{\n          uploadData.append(k, body[k]);\n        });\n        uploadData.append('file_name', uploadFile.name);\n        uploadData.append('file', uploadFile.binaryFile);\n        this.headers.set('Content-Type',undefined);\n        body = uploadData;\n      }\n\n      if (this.config.upload.method.toLowerCase() === 'post') {\n        uploadRequest =  this.http.post(this.config.upload.url,body, {\n          reportProgress: true,\n          observe: 'events',\n          headers:this.headers});\n      } else if (this.config.upload.method.toLowerCase() === 'put') {\n        uploadRequest =  this.http.put(this.config.upload.url,body, {reportProgress: true,\n          observe: 'events',headers:this.headers});\n      }\n      this.previewFiles[index].uploadStatus = true;\n      uploadRequest.subscribe((event: HttpEvent<any>)=>{\n        switch (event.type) {\n          case HttpEventType.UploadProgress:\n            this.previewFiles[index].progress = Math.round(event.loaded / event.total * 100);\n            break;\n          case HttpEventType.Response:\n            setTimeout(() => {\n              this.previewFiles[index].progress = 0;\n            }, 1500);\n            break;\n            \n        }\n      });\n    }\n  }\n  uploadAllFile() {\n    this.previewFiles.forEach((file, index)=>{\n      this.uploadFile(index);\n    });\n  }\n  resetFileProcess() {\n    this.previewFiles = [];\n    this.files = [];\n    this.fileUploader.nativeElement.value = null;\n  }\n\n\n}\n","import { NgModule } from '@angular/core';\nimport { MultiUploaderComponent } from './multi-uploader.component';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { FormsModule } from '@angular/forms';\n\n\n@NgModule({\n  declarations: [MultiUploaderComponent],\n  imports: [\n    BrowserModule,\n    FormsModule\n  ],\n  exports: [MultiUploaderComponent]\n})\nexport class MultiUploaderModule { }\n"],"names":[],"mappings":"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"}